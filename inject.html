<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inject Code Developer Mode</title>
</head>
<body>
    

    <!-- Pixiv x Cloudinary Original Size -->
    <script>
        const GetElementImages = document.querySelectorAll('.gtm-expand-full-size-illust');

        GetElementImages.forEach(link => {
            const img       = link.querySelector('img');
            const newSrc    = link.getAttribute('href');
            img.setAttribute('src', newSrc);
        });

    </script>

    <!-- Pixiv x Cloudinary Thumbnail -->
    <script>
        const GetElementArtist  = document.querySelector('.sc-d98f2c-0.sc-cwiweh').textContent;
        const GetElementImage   = document.querySelectorAll('.sc-1qpw8k9-1.jOmqKq');
        const GetElementTitle   = document.querySelector('.sc-1u8nu73-3.lfwBiP').textContent;
        const GetElementTag     = document.querySelectorAll("ul.gZfuPH a");
        const GetElementCode    = document.querySelector('.eStCAU');
        const GetData           = new Date();

        const ArrayTag          = Array.from(GetElementTag);
        const ArrayImage        = Array.from(GetElementImage, img => img.getAttribute('src').split('/').pop().replace('.jpg', ''));
        
        const FilterTag         = ArrayTag.filter((link) => !link.classList.contains("gtm-new-work-tag-event-click"));
        const FilterDate        = GetData.toISOString();
        
        const DataSlug          = btoa(unescape(encodeURIComponent(GetElementTitle)));
        const DataTag           = FilterTag.map((link) => link.textContent);
        const DataCover         = `https://res.cloudinary.com/dvdute5j8/image/upload/c_scale,w_240/Nsfw/${GetElementArtist}/${ArrayImage[0]}.webp`;
        const DataImage         = Array.from(ArrayImage, doc => `https://res.cloudinary.com/dvdute5j8/image/upload/Nsfw/${GetElementArtist}/${doc}.webp`)

   
        const NewElement = `
            <div style="padding:10px;">
                <p>Full Data</p>
                <textarea style="width: -webkit-fill-available;height: 400px; border: none; border-radius: 5px; background: #4c4c4c;padding: 10px; color:white; margin-bottom:20px">
                    {
                        "Type"   : "nsfw",
                        "Artist" : "${GetElementArtist}",
                        "Post"   : [
                            {
                                "Title"     : "${GetElementTitle}",
                                "Slug"      : "${btoa(unescape(encodeURIComponent(FilterDate)))}",
                                "Tag"       : [${DataTag.map(doc => `"${doc}"` )}],
                                "Cover"     : "${DataCover}",
                                "Image"     : [${DataImage.map(doc => `"${doc}"` )}],
                                "Uploaded"  : "${FilterDate.slice(0, 10)}"
                            }
                        ]
                    }
                </textarea>
            </div>
        `;

        GetElementCode.innerHTML += NewElement;
    </script>


    <script>
        var getSource   = document.querySelector(".fp-player video").src;
        var getTitle    = document.querySelector('.heading__title').textContent;
        var getSeries   = document.querySelector('.trailer__cols .trailer__col .btn-group .btn-group__item .btn--primary').textContent;
        var getTags     = document.querySelectorAll('.trailer__cols .trailer__col .btn-group .btn-group__item .btn--primary');
        var allowedTags = ["360p","480p","720p","1080p"];

        var dataTags = [];

        getTags.forEach(function (element) {
            if (!allowedTags.includes(element.textContent)) {
                dataTags.push(element.textContent);
            }
        });

        document.querySelector(".trailer__row .comments").innerHTML =
            `
            <div>
                <textarea style="height:250px; width:100%; font-size:7pt">
                    {
                        "Source"       : "${getSource}",
                        "Title"        : "${getTitle}",
                        "Series"       : "${getSeries}",
                        "Tags"         : ${JSON.stringify(dataTags)},
                        "Released"     : ${JSON.stringify(dataTags.find(item => /^\d{4}$/.test(item)))},
                        "Uploaded"     : "${new Date().toISOString().slice(0, 10)}"
                    }
                </textarea>
            </div>
        `;
    </script>
</body>
</html>